<template name="chat">
    <div id="chat" class="chat" fit>
	    {{#contentFor "rightMenu"}}
		    {{>allUserList}}
	    {{/contentFor}}
        <div id="chat-content" class='chat-content'>
		{{#if Template.subscriptionsReady}}

			{{#contentFor "topMenu"}}
                            <div class="dialog-menu">
				    {{#if isEmbeddedChat}}
                                        <paper-icon-button title="Open menu" class="left toggle-main-menu" icon="menu"
                                                           onclick="GlobalUI.toggleLeftMenu()"></paper-icon-button>
				    {{/if}}
                                <span class="left name">{{currentDialogName}}</span>

				    {{#if isEmbeddedChat}}
                                        <paper-icon-button icon="editor:vertical-align-bottom"
                                                           class="right minify-btn"></paper-icon-button>
                                        <paper-icon-button icon="communication:call-made"
                                                           class="right maximize-btn hide"></paper-icon-button>
				    {{/if}}
                                <paper-icon-button icon="supervisor-account"
                                                   class="right all-users-button"></paper-icon-button>
                            </div>
			{{/contentFor}}
		{{/if}}
		{{#if currentDialog}}
                    <div id="messages-container" class='messages-container'>
                        <div class="messages-container-scroll" fit>
				{{#unless isMessagesReady}}
					{{>loading }}
				{{else}}
                                    <div class="messages">


					    {{#each chatMessages}}

						    {{> chatMessage}}

					    {{/each}}

                                        <script>
                                            $("#chat").trigger(MESSAGES_READY_EVENT);
                                        </script>

                                    </div>
				{{/unless}}
                        </div>
                    </div>



		{{else}}

                    <span>
			    {{_ "chat.welcomeMessage"}}

                    </span>

		{{/if}}

		{{> chatTextArea}}
        </div>
	    {{> mentions_styles}}
    </div>

</template>

