<template name="chat">
    <div class="chat" fit>

        <div class='chat-content'>
{{#if Template.subscriptionsReady}}

{{#contentFor "topMenu"}}
            <div class="dialog-menu">
		    {{#if isEmbeddedChat}}
                        <paper-icon-button title="Open menu" class="left toggle-main-menu" icon="menu"
                                           onclick="GlobalUI.toggleLeftMenu()"></paper-icon-button>
		    {{/if}}
                        <span class="left name">{{currentDialogName}}</span>

		    {{#if isEmbeddedChat}}
                        <paper-icon-button icon="editor:vertical-align-bottom"
                                           class="right minify-btn"></paper-icon-button>
                        <paper-icon-button icon="communication:call-made"
                                           class="right maximize-btn hide"></paper-icon-button>
		    {{/if}}
                <paper-icon-button icon="supervisor-account" class="right all-users-button"></paper-icon-button>
            </div>
{{/contentFor}}
		{{#if currentDialog}}
                    <div class='messages-container'>
                        <div class="messages-container-scroll" fit>
                                <div id="space-filler"></div>
                                <div id="messages-content">
                                        {{#if hasMoreMessages}}
                                            <div class="show-more">
                                                Show more
                                            </div>
                                        {{/if}}
                                        {{#each chatMessages}}
                                                {{> chatMessage}}
                                        {{/each}}
                                        {{#if hasUnreadMessages}}
                                            <div id="unread-separator"></div>
                                        {{/if}}
                                        {{#each chatMessagesUnread}}
                                                {{> chatMessage}}
                                        {{/each}}
                                    <div id="last-message"></div>
                                </div>
                        </div>
                    </div>
			{{#unless Template.subscriptionsReady}}
                            <div class="fader" fit layout>
                                <paper-spinner active></paper-spinner>
                            </div>
			{{/unless}}
			{{> chatTextArea}}
		{{else}}
                    <paper-button class="welcome-btn">
                    <span>
                        {{i18nChooseUserToChat}}
                        <core-icon icon="chevron-right"></core-icon>
                    </span>
                    </paper-button>
		{{/if}}
{{else}}
        {{>loading}}
{{/if}}
        </div>
        <style>
            .chat-message [mentions={{currentUser._id}}], .chat-message [mentions=all] {
                background: #3b73af;
                border: 1px solid #3b73af;
                color: #fff;
            }
        </style>

    </div>

</template>

